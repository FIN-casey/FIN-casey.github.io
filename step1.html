<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<title>FB-Osmose Bridge</title>
<link rel="stylesheet" href="screen.css" type="text/css">
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="funcWizard.js"></script>
<script src="underscore-min.js" type="text/javascript"></script>
<script src="jquery.form-validator.min.js" type="text/javascript"></script>
<script type="text/javascript">
//$(document).ready(function () {
var ecosystemCount = 0;
var ecosystem = ['https://fishbase.ropensci.org/ecosystem?limit=5000'];

$.ajax({
	type: 'GET',
	url: "ecosystem.json",
	success: function (result) {
		
		$.each(result, function(index, element){
			$('#ecosystem').append($('<option>', {
				text: element.EcosystemName,
				value: element.E_CODE + ""
			}));
		});
		
	},
	error: function(XMLHttpRequest, textStatus, errorThrown) {
		alert(textStatus);
	}
});

$.ajax({
	type: 'GET',
	url: "https://fishbase.ropensci.org/countref?limit=500&fields=C_Code,Note",
	success: function (result) {
		
		var byCountry = result.data.slice(0);
		byCountry.sort(function(a,b){
			var x = a.Note.toLowerCase();
			var y = b.Note.toLowerCase();
			return x < y ? -1 : x > y ? 1 : 0;
		});
		
		$.each(byCountry, function(index, element){
			
			$('#country').append($('<option>', {
				text: element.Note,
				value: "" + element.C_Code
			}));
		});
		
	},
	error: function(XMLHttpRequest, textStatus, errorThrown) {
		alert(textStatus);
	}
});

function validateform(){
	if(document.step1Form.choose.value == "eco"){
		if(document.step1Form.ecosystem.value == ""){
			alert("Please select an ecosystem!");
			document.step1Form.ecosystem.focus();
			return false;
		}
		return true;
	}
	if(document.step1Form.choose.value == "cntry"){
		if(document.step1Form.country.value == ""){
			alert("Please select a country!");
			document.step1Form.country.focus();
			return false;
		}
		if(document.step1Form.country.value == "840"){
			if(document.step1Form.subcountry.value == ""){
				alert("Please select a subcountry!");
				document.step1Form.subcountry.focus();
				return false;
			}
		}
		if(document.step1Form.faoarea.value == ""){
			alert("Please select a faoarea!");
			document.step1Form.faoarea.focus();
			return false;
		}
		return true;
	}
}

//});
</script>
</head>
<body>

	<div class="pheader">Step 1: Getting parameter estimates for your OSMOSE model</div>
	<div id="container">
		<p class="justify13">You are about to query parameter estimates for your OSMOSE model.</p>

		<p class="justify13">To get started, please select an ecosystem or a combination of a country and FAO area.</p>
		
		<form action="step2.html" method="get" id="step1Form" name="step1Form" onsubmit="return validateform();">
		
		<div id="selectecosystem">
			<div class="floatLeft width5">
				<input type="radio" name="choose" id="eco" value="eco" checked onchange="changeEcoOrCountry()"></input>
			</div>
			<div class="padTop10" id="ecoDiv">
				<div class="w200 floatLeft">
					 <b><i>Ecosystem</i></b> 
				</div>
				<select name="ecosystem" id="ecosystem" title="Please select ecosystem!">
					<option value="" selected="selected">Select</option>
				</select>
			</div>
		</div>
			<hr>
		<div id="selectcountry">
			<div class="floatLeft width5">
				<input type="radio" name="choose"  value="cntry" onchange="changeEcoOrCountry()"></input>
			</div>
			<div class="overflow-hidden" id="countryDiv">
				<div class="padTop10">
					<div class="w200 floatLeft">
						 <b><i>Country</i></b> 
					</div>
					<select name="country" id="country" onchange="listSubCountry()" title="Please select country!" disabled>
						<option value="">Select</option>
					</select>
				</div>
				<div class="padTop10">
					<div class="w200 floatLeft">
						 <b><i>Sub-country</i></b> 
					</div>
					<select name="subcountry" id="subcountry" title="Please select sub-country!" disabled>
						<option value="" selected="selected">Select</option>
					</select>
				</div>
				<div class="padTop10">
					<div class="w200 floatLeft">
						 <b><i>FAO Area</i></b> 
					</div>
					<select name="faoarea" id="faoarea" title="Please select FAO area!" disabled>
						<option value="" selected>Select</option>
					</select>
				</div>
			</div>
		</div>
		
		<div class="padTop10">
			<input type="submit" name="submitBtn" value="Proceed"/>
			
			<input type="button" name="exit" value="Exit" onClick="parent.location='step1.html'"></input>
		</div>
		</form>
	</div>
	
	<div id="locid"></div>
</body>
</html>